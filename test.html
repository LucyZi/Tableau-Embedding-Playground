<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My embedded Tableau visualization</title>
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
        }
        #navContainer {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        button {
            padding: 10px 15px;
            background-color: #f0f0f0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
        }
        button.active {
            background-color: #007bff;
            color: white;
        }
        tableau-viz {
            flex-grow: 1;
            width: 100%; /* Ensures that the viz takes the remaining height */
        }
    </style>
</head>
<body>
    <div id="navContainer">
        <button data-dashboard="1">Dashboard 1</button>
        <button data-dashboard="2">Dashboard 2</button>
        <button data-dashboard="3">Dashboard 3</button>
    </div>
    <tableau-viz id="tableauViz"
        src="https://public.tableau.com/views/DeveloperSuperstore/Overview"
        device="desktop"
        hide-tabs="true"
        toolbar="hidden"
    ></tableau-viz>
    <script type="module">
        import { TableauViz, TableauEventType } from 'https://public.tableau.com/javascripts/api/tableau.embedding.3.latest.min.js';

        const dashboards = [
            { name: 'Dashboard 1', url: 'https://public.tableau.com/views/US_regrouped_layer1/HBMCataGlance_map' },
            { name: 'Dashboard 2', url: 'https://public.tableau.com/views/US_regrouped_layer2/HBMCataGlance_map' },
            { name: 'Dashboard 3', url: 'https://public.tableau.com/views/IL-Cook/HBMCataGlance_map' }
        ];

        document.querySelectorAll('#navContainer button').forEach((button, index) => {
            button.addEventListener('click', () => {
                loadDashboard(index);
                setActiveButton(index);
            });
        });

        function setActiveButton(activeIndex) {
            document.querySelectorAll('#navContainer button').forEach((btn, idx) => {
                if (idx === activeIndex) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
        }

        async function loadDashboard(index) {
            const viz = document.getElementById('tableauViz');
            viz.src = dashboards[index].url;

            try {
                await new Promise((resolve, reject) => {
                    viz.addEventListener(TableauEventType.FirstInteractive, resolve);
                    viz.addEventListener(TableauEventType.VizLoadError, (error) => {
                        console.error('Error loading dashboard:', error);
                        reject(new Error('Dashboard loading failed'));
                    });
                });
                console.log('Dashboard is interactive!');
            } catch (error) {
                alert('Failed to load dashboard. Please try again later.');
            }
        }

        // Load the first dashboard initially
        loadDashboard(0);
        setActiveButton(0);
    </script>
</body>
</html>
